 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
 <html>
 <head>
 <meta http-equiv ="Content-Type" content ="text/html;charset=gb2312">
 <title> RSS </title>
 <style type ="text/css">
a{
color:black;
}
a:hover
{
color:Green;
}
a:active
{
color:Red;
}
a:link
{
color:Blue;
}
 </style>
 <script  chartset ="utf-8">
function $(objectid){return document.getElementById(objectid);}
var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
xmlDoc.async="false";
xmlDoc.load("http://news.qq.com/now.xml");
//"https://rsshub.app/twitter/user/huiqiang233");
var nodes=null;
var hasData=true;
var array;
nodes = xmlDoc.selectNodes("/rss/channel/item");
if(nodes==null)
{
hasData=false;
rss.innerText = "没有发现数据";
}
else
  array=new Array(nodes.length);


function list(pagesize,pagenum)
{
    if(!hasData)
    rss.innerText = "没有发现数据";

    else
    {
    xx=nodes.length;
    $("pages").innerHTML="";
    for(var pagen=1;pagen<(xx+pagesize-1)/pagesize;pagen++)
       if(pagen!=pagenum)
       $("pages").innerHTML+="<a href='javascript:list("+pagesize+","+pagen+")'>"+pagen+"</a>&nbsp;";
       else
       $("pages").innerHTML+="<font color='red'>"+pagen+"</font>&nbsp;";

    rss.innerHTML = "";
    xx=nodes.length;
    if(xx>pagesize*(pagenum-1))
    xx=pagesize*(pagenum-1);
        for(i=pagesize*(pagenum-1);i<pagesize*pagenum;i++){
            if(i<nodes.length)
            {
            //
            rss.innerHTML +="<li><a href='javascript:GetDetail("+i+")' οnmοusemοve='showProduce("+i+")'>" + nodes[i].selectSingleNode("title").text + "</a></li>";
            array[i-1]={
                    title:nodes[i].selectSingleNode("title").text,
                    link:nodes[i].selectSingleNode("link").text,
                    description:nodes[i].selectSingleNode("description").text,
                    pubDate:nodes[i].selectSingleNode("pubDate").text
                   }
            }
        }
    }
}
function GetDetail(id)
{
window.open(array[id-1].link);
}
function showProduce(id)
{
$("details").innerHTML="标题:<a href='javascript:GetDetail("+id+")'>"+array[id-1].title+"</a>";
$("details").innerHTML+="<br/>发布时间:"+array[id-1].pubDate;
$("details").innerHTML+="<br/>"+array[id-1].description;
}
window.onload=function()
{
list(9,1);
}
 </script>
 </head>
 <body>
 <div id ="rss"></div>
 <div id ="pages"></div>
 <p>
 <div  id ="details"></div>
 </p>
 </body>
 </html>  
